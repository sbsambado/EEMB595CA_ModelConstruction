---
title: "Tick and Host SIS"
author: "sbsambado"
date: "4/7/2020"
output: html_document
---
```{r}
SIS.model.tick.host <- function(t, x, params) {
  S = x[1] # susceptible host
  I = x[2] # infected host
  U = x[3] # susceptible vector
  V = x[4] # infected vector
  
  beta = params[1] # inoculation
  alpha = params[2] # acquisition
  gamma = params[3] # host turnover I > S
  birth_v = params[4] # birth of vectors
  death_v = params[5] # death of vectors
  
  dSdt = - (beta*S*V)/(S + I) + gamma*I # S + I = N_host
  dIdt = (beta*S*V)/(S + I) - gamma*I
  dUdt = - (alpha*U*I)/(U + V) + birth_v*U - death_v*U # U + V = N_vector
  dVdt = (alpha*U*I)/(U + V) + birth_v*V - death_v*V
  
  return(list(c(dSdt, dIdt, dUdt, dVdt)))
}
  
S0 = 29
I0 = 1
U0 = 99
V0 = 1

initial_values = c(S0, I0, U0, V0)

  beta = 0.9 # inoculation
  alpha = 0.8  # acquisition
  gamma = 0.2 # host turnover I > S
  birth_v = 0.2 # birth of vectors
  death_v = 0.5 # death of vectors

parameters = c(beta, alpha, gamma, birth_v, death_v) 

times = seq(0,30, 0.1)

results = lsoda(initial_values, times, SIS.model.tick.host, parameters)
colnames(results) = c('time', 'susceptible host', 'infected host', 'susceptible tick', 'infected tick')
head(results)  
  
plot(results[, 'time'], results[,'susceptible host'], type = 'l', col = 'blue', 
     xlab = 'time', ylab = 'abundance', ylim = c(0,101), lty = 1)
lines(results[,'time'], results[,'infected host'], type = 'l', col = 'blue', lty = 2)
lines(results[,'time'], results[,'susceptible tick'], type = 'l', col = 'red', lty = 1)
lines(results[,'time'], results[,'infected tick'], type = 'l', col = 'red', lty = 2)
legend('topleft', legend = c('U hosts', 'I host', 'U vector', 'I vector'),
       col = c('blue', 'blue', 'red', 'red'), lwd = 2, lty = c(1,2,1,2), cex = 0.6)
```

